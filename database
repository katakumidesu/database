CREATE DATABASE Katakumi;
USE Katakumi;

CREATE TABLE users(
user_id int auto_increment primary key,
name varchar(99) not null,
email varchar(99)unique not null,
password_hash varchar(99) not null,
phone int(11),
role enum("user","admin") default 'user',
created_at timestamp default current_timestamp);

CREATE TABLE Categories(
category_id int auto_increment primary key,
category_name varchar(99) not null);

CREATE TABLE Products(
product_id int auto_increment primary key,
category_id int,
name varchar(99) not null,
description text,
price decimal(10,2) not null,
stock int default 0,
image_url varchar(255),
create_at timestamp default current_timestamp,
foreign key (category_id) references categories (category_id));

CREATE TABLE Orders(
order_id int auto_increment primary key,
user_id INT NULL,
customer_name varchar(99) not null,
customer_phone varchar(99) not null,
oder_date timestamp default current_timestamp,
status enum('pending', 'processing','shipped','delivered','cancelled') default 'pending',
total_amount decimal(10.2),
foreign key (user_id) references users (user_id));

CREATE TABLE OrderDetails(
order_table_id int auto_increment primary key,
order_id int,
product_id int,
quantity int not null,
price decimal(10.2)not null,
foreign key (order_id) references orders (order_id),
foreign key (product_id) references products (product_id));

CREATE TABLE Payments(
payment_id int auto_increment primary key,
order_id int,
amount decimal(10.2)not null,
payment_date timestamp default current_timestamp,
method enum('credit card', 'debit card', 'cash', 'cod', 'gcash')not null,
foreign key (order_id) references orders (order_id));

CREATE TABLE Delivery(
delivery_id int auto_increment primary key,
order_id int,
address varchar(255) not null,
city varchar(255) not null,
baranggay varchar(255) not null,
postal_code int(4),
country varchar(100) default 'philippines',
delivery_date date,
status enum('preparing','out for delivery','deliverd') default 'preparing',
foreign key (order_id) references orders (order_id));

